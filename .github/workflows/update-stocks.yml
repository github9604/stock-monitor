name: ğŸ“ˆ ì£¼ì‹ ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸

on:
  # 5ë¶„ë§ˆë‹¤ ì‹¤í–‰ (ì‹œì¥ ì‹œê°„ëŒ€ì— ë§ì¶° ì¡°ì • ê°€ëŠ¥)
  schedule:
    - cron: '*/5 * * * *'  # ë§¤ 5ë¶„ë§ˆë‹¤
  
  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥
  workflow_dispatch:
  
  # Push ì‹œì—ë„ ì‹¤í–‰ (í…ŒìŠ¤íŠ¸ìš©)
  push:
    branches: [ main ]

jobs:
  update-stock-data:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4
    
    - name: ğŸ Python ì„¤ì •
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
        cache: 'pip'
    
    - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        pip install -r requirements.txt
    
    - name: ğŸš€ ì£¼ì‹ ë°ì´í„° ì—…ë°ì´íŠ¸
      env:
        NOTION_API_KEY: ${{ secrets.NOTION_API_KEY }}
        NOTION_DATABASE_ID: ${{ secrets.NOTION_DATABASE_ID }}
        STOCK_TICKERS: ${{ secrets.STOCK_TICKERS }}
      run: |
        python update_stocks.py
    
    - name: ğŸ“Š ê²°ê³¼ ìš”ì•½
      if: always()
      run: |
        echo "âœ… ì£¼ì‹ ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ"
        echo "â° $(date)"
